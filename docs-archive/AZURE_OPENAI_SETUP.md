# Azure OpenAI Setup for AI-Powered Recommendations

## Overview

The AI Visibility Dashboard can provide **context-aware, AI-powered recommendations** for improving LLM discoverability. These recommendations are generated by Azure OpenAI (GPT-4) and are based on:

- Actual page content analysis
- Real user search patterns
- LLM presence scoring factors
- Page type classification
- Best practices learned from similar pages

## Without Azure OpenAI Key

If you don't set an Azure OpenAI key, the tool will still work but:
- ❌ No AI-powered recommendations
- ✅ LLM presence scores still calculated
- ✅ Content summaries still generated
- ✅ User prompts still generated (Awareness, Consideration, Conversion)

## Setting Up Azure OpenAI

### Option 1: Environment Variable (Recommended)

**Windows (PowerShell):**
```powershell
$env:AZURE_OPENAI_KEY = "your-azure-openai-api-key"
cd C:\AIVisibilityDashboard\backend
node server.js
```

**Windows (Permanent):**
1. Search for "Environment Variables" in Windows
2. Add new User or System variable:
   - Name: `AZURE_OPENAI_KEY`
   - Value: `your-azure-openai-api-key`
3. Restart your terminal/PowerShell
4. Start the backend server

**Linux/Mac:**
```bash
export AZURE_OPENAI_KEY="your-azure-openai-api-key"
cd /path/to/AIVisibilityDashboard/backend
node server.js
```

### Option 2: .env File

1. Create a `.env` file in the `backend` folder:

```bash
cd C:\AIVisibilityDashboard\backend
echo AZURE_OPENAI_KEY=your-azure-openai-api-key > .env
```

2. Install dotenv package (if not already installed):

```bash
npm install dotenv
```

3. Update `server.js` to load .env:

```javascript
require('dotenv').config();
```

### Getting Your Azure OpenAI Key

1. **Log in to Azure Portal**: https://portal.azure.com
2. **Navigate to Azure OpenAI Service**
3. **Select your resource**
4. **Go to "Keys and Endpoint"**
5. **Copy one of the keys** (Key 1 or Key 2)

### Current Configuration

The tool uses these Azure OpenAI settings:
- **Endpoint**: `https://aem-sites-1-genai-us-east-2.openai.azure.com`
- **API Version**: `2024-02-01`
- **Deployment**: `gpt-4o`

If your Azure OpenAI configuration is different, update these in:
- `backend/services/hybridContentAnalyzer.js` (lines 18-21)

## Verifying Setup

When you start the backend server, you'll see:

```
✅ Azure OpenAI (optional)    <- Key is set
```

or

```
⚠️  Azure OpenAI (optional)    <- Key is NOT set
```

## What You Get with AI Recommendations

### Without Azure OpenAI:
```
AI Recommendations Not Available
To get context-aware, AI-powered recommendations, set the AZURE_OPENAI_KEY...
```

### With Azure OpenAI:
```
AI-Powered Recommendations

1. Add H2 heading "How to Create a Free QR Code in 3 Steps" to match 
   top search query "qr code generator free" and emphasize "free" in 
   first paragraph (currently missing)

2. First paragraph is 45 chars (too short). Expand to 120-150 chars and 
   include key terms: "free", "online", "secure" to improve snippet quality

3. Add FAQ section with 3-5 questions matching user queries: "Is it really 
   free?", "Do I need to sign up?", "What formats are supported?"

4. Content lacks current year (2024) mentions - add to demonstrate freshness 
   and that features are up-to-date

5. Include step-by-step instructions (currently has 0) - users search 
   "how to create qr code" expecting concrete steps
```

## Cost Considerations

Azure OpenAI API calls are charged based on:
- **Input tokens**: Text sent for analysis
- **Output tokens**: Recommendations generated

**Estimated cost per URL**: $0.01 - $0.05 (depending on page length)

**Tips to reduce costs:**
- Only analyze URLs that need recommendations
- Start with a small subset to test
- Review Azure OpenAI pricing: https://azure.microsoft.com/pricing/details/cognitive-services/openai-service/

## Troubleshooting

### "AI insights not available"
- ❌ Azure OpenAI key not set
- ✅ Set `AZURE_OPENAI_KEY` environment variable

### API errors
- Check your Azure OpenAI endpoint and deployment name
- Verify your API key is valid
- Check Azure OpenAI service quota and limits

### Empty recommendations
- This can happen if the AI determines no improvements are needed
- Try analyzing a different URL

## Questions?

For more details on the LLM presence tracking methodology, see:
- `EXPERIMENTAL_llm-presence-tracker/README.md`
- `EXPERIMENTAL_llm-presence-tracker/docs/`

